"use strict";var CipherTool={langmap:{en:"English",nl:"Dutch",de:"German",eo:"Esperanto",es:"Spanish",fr:"French",it:"Italian",no:"Norwegian",pt:"Portuguese",sv:"Swedish",ia:"Interlingua",la:"Latin"},langcharset:{en:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",nl:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",de:"AÄBCDEFGHIJKLMNOÖPQRSßTUÜVWXYZ",eo:"ABCĈDEFGĜHĤIJĴKLMNOPRSŜTUŬVZ",es:"ABCDEFGHIJKLMNÑOPQRSTUVWXYZ",fr:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",it:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",no:"ABCDEFGHIJKLMNOPQRSTUVWXYZÅØÆ",pt:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",sv:"AÅÄBCDEFGHIJKLMNOÖPQRSTUVWXYZ",ia:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",la:"ABCDEFGHIJKLMNOPQRSTUVWXYZ"},langreplace:{en:{},nl:{},de:{},eo:{},es:{"Á":"A","É":"E","Í":"I","Ó":"O","Ú":"U","Ü":"U","Ý":"Y"},fr:{"Ç":"C","Â":"A","À":"A","É":"E","Ê":"E","È":"E","Ë":"E","Î":"I","Ï":"I","Ô":"O","Û":"U","Ù":"U","Ü":"U"},it:{"É":"E","È":"E","Ì":"I","Ò":"O","Ù":"U"},no:{},pt:{"Á":"A","Â":"A","Ã":"A","À":"A","Ç":"C","È":"E","Ê":"E","Í":"I","Ó":"O","Ô":"O","Õ":"O","Ú":"U"},sv:{},ia:{},la:{}},tomorse:{" ":"",A:"O-",B:"-OOO",C:"-O-O",D:"-OO",E:"O",F:"OO-O",G:"--O",H:"OOOO",I:"OO",J:"O---",K:"-O-",L:"O-OO",M:"--",N:"-O",O:"---",P:"O--O",Q:"--O-",R:"O-O",S:"OOO",T:"-",U:"OO-",V:"OOO-",W:"O--",X:"-OO-",Y:"-O--",Z:"--OO",1:"O----",2:"OO---",3:"OOO--",4:"OOOO-",5:"OOOOO",6:"-OOOO",7:"--OOO",8:"---OO",9:"----O",0:"-----",",":"--OO--",".":"O-O-O-","?":"OO--OO","/":"-OO-O","-":"-OOOO-","()":"-O--O-"},morsedigitClass:{O:"dot","-":"dash","?":"error",X:"null"},morseClass:{A:"",B:"",C:"",D:"",E:"",F:"",G:"",H:"",I:"",J:"",K:"",L:"",M:"",N:"",O:"",P:"",Q:"",R:"",S:"",T:"",U:"",V:"",W:"",X:"",Y:"",Z:"",1:"num",2:"num",3:"num",4:"num",5:"num",6:"num",7:"num",8:"num",9:"num",0:"num",",":"sym",".":"sym","?":"sym","/":"sym","-":"sym","()":"sym"},frommorse:{"O-":"A","-OOO":"B","-O-O":"C","-OO":"D",O:"E","OO-O":"F","--O":"G",OOOO:"H",OO:"I","O---":"J","-O-":"K","O-OO":"L","--":"M","-O":"N","---":"O","O--O":"P","--O-":"Q","O-O":"R",OOO:"S","-":"T","OO-":"U","OOO-":"V","O--":"W","-OO-":"X","-O--":"Y","--OO":"Z","O----":"1","OO---":"2","OOO--":"3","OOOO-":"4",OOOOO:"5","-OOOO":"6","--OOO":"7","---OO":"8","----O":"9","-----":"0","--OO--":",","O-O-O-":".","OO--OO":"?","-OO-O":"/","-OOOO-":"-","-O--O-":"()"},morseLocked:{},morbitMap:{1:"OO",2:"O-",3:"OX",4:"-O",5:"--",6:"-X",7:"XO",8:"X-",9:"XX"},fractionatedMorseMap:{A:"OOO",B:"OO-",C:"OOX",D:"O-O",E:"O--",F:"O-X",G:"OXO",H:"OX-",I:"OXX",J:"-OO",K:"-O-",L:"-OX",M:"--O",N:"---",O:"--X",P:"-XO",Q:"-X-",R:"-XX",S:"XOO",T:"XO-",U:"XOX",V:"X-O",W:"X--",X:"X-X",Y:"XXO",Z:"XX-"},langfreq:{en:{E:.1249,T:.0928,A:.0804,O:.0764,I:.0757,N:.0723,S:.0651,R:.0628,H:.0505,L:.0407,D:.0382,C:.0334,U:.0273,M:.0251,F:.024,P:.0214,G:.0187,W:.0168,Y:.0166,B:.0148,V:.0105,K:.0054,X:.0023,J:.0016,Q:.0012,Z:9e-4},nl:{E:.204011,N:.112494,T:.0668511,A:.0562471,O:.0534809,I:.0525588,R:.0509451,D:.0447211,S:.0421853,L:.0295067,G:.027432,H:.0246657,M:.0239742,V:.0214385,B:.0189027,W:.0189027,K:.0186722,U:.0165975,P:.0156754,C:.0147533,IJ:.0124481,Z:.0119871,J:.0080682,F:.005302,"É":.0011526,X:2305e-7,Q:0},de:{E:.149958,N:.10262,I:.0826712,S:.0814877,R:.0704987,A:.0644125,T:.0486898,H:.0468301,D:.046661,U:.0365173,G:.0360101,L:.0339814,B:.0255283,O:.0255283,F:.019104,V:.016399,K:.0162299,M:.0162299,W:.0155537,Z:.008115,"Ü":.0079459,P:.0064243,"Ä":.0050719,"Ö":.0030431,J:.002705,"ß":6762e-7,Q:1691e-7,C:0,X:0,Y:0},eo:{A:.122894,E:.0982128,O:.0917447,N:.0837447,I:.0791489,S:.0568511,R:.0558298,T:.0556596,L:.0549787,K:.0408511,M:.0309787,P:.0308085,D:.0294468,U:.0292766,J:.0248511,V:.0228085,G:.0153191,B:.0093617,C:.0088511,F:.0069787,"Ü":.0062979,Z:.0061277,H:.0059575,"Ĝ":.0054468,"Ĉ":.0040851,"Ŝ":.0011915,"Ĵ":.0010213,"Ĥ":0},es:{E:.1408,A:.1216,O:.092,S:.072,N:.0683,R:.0641,I:.0598,L:.0524,U:.0469,D:.0467,T:.046,C:.0387,M:.0308,P:.0289,B:.0149,H:.0118,Q:.0111,Y:.0109,V:.0105,G:.01,F:.0069,J:.0052,Z:.0047,"Ñ":.0017,X:.0014,K:.0011,W:4e-4},fr:{E:.1406753,T:.0895584,I:.0820779,N:.0792727,S:.0753247,A:.073039,R:.065039,O:.0643117,L:.0571429,U:.0520519,D:.0457143,C:.0353247,"É":.0268052,P:.0253506,M:.0225455,V:.0093506,G:.0085195,Q:.0083117,F:.0082078,B:.0078961,"À":.0065455,H:.0047792,X:.0045714,"Ê":.0023896,Y:.0020779,J:.0011429,"È":.001039,"Ù":4156e-7,"Â":2078e-7,"Ô":2078e-7,"Û":1039e-7},it:{I:.137609,E:.104323,A:.0923483,O:.0921453,T:.0574386,N:.0572356,L:.0566268,R:.0539882,S:.0527704,C:.0481023,G:.038563,U:.0355186,D:.033083,P:.0300386,M:.0271971,B:.0142074,H:.0125837,Z:.0125837,"È":.0103511,V:.0101482,F:.0085245,Q:.00548,J:0,K:0,W:0,X:0,Y:0},no:{E:.16463,N:.0888383,A:.067923,I:.0668876,R:.0646096,D:.0635742,T:.0635742,S:.0509422,L:.0499068,O:.0399669,G:.0397598,V:.0395527,K:.0339615,M:.0304411,H:.0298198,F:.0217436,U:.0155312,P:.0130462,B:.0113895,J:.0097329,"Ø":.0082833,"Å":.0070408,Y:.0057983,"Æ":0},pt:{E:.148438,A:.121094,O:.102711,I:.0714614,R:.0597426,S:.0574449,D:.053079,M:.0500919,T:.0500919,N:.0471048,U:.0381434,C:.0358456,L:.0310202,V:.0186121,P:.0183824,G:.0126379,B:.0091912,"Ã":.0087316,Q:.0082721,F:.0080423,H:.0080423,"Ç":.0055147,Z:.0032169,"Á":.0029871,"Ê":.0029871,NH:.0025276,"É":.0022978,J:.0018382,"Ó":.0016085,X:.0013787,LH:9191e-7,"Â":4596e-7,"Õ":2298e-7,W:0,Y:0},sv:{N:.102144,A:.0962783,E:.0958738,R:.0671521,T:.0647249,I:.0552184,S:.0533981,D:.0523867,L:.0517799,O:.0410599,V:.0400485,H:.0386327,M:.0351942,G:.0287217,K:.0287217,F:.0218447,"Ä":.0212379,"Ö":.0147654,P:.0141586,C:.0141586,"Å":.013754,U:.0133495,B:.0121359,J:.00768608,Y:.0052589,X:202265e-9},ia:{E:.1729506,T:.0905528,A:.0898115,I:.0847278,O:.0773141,N:.0724423,R:.0647109,L:.064499,S:.0635459,C:.0420462,D:.0416225,U:.035268,P:.0267952,M:.021076,B:.0102732,H:.0083669,V:.0083669,F:.008261,G:.0075196,Q:.0073078,J:9532e-7,X:9532e-7,Y:6355e-7,K:0,W:0,Z:0},la:{I:.1333172,E:.123415,T:.0906895,A:.0809081,S:.0775269,U:.075957,N:.0640019,O:.058447,R:.0528922,M:.0495109,C:.0362275,P:.0299481,D:.0266876,L:.0251177,Q:.0163024,B:.0161816,G:.0108683,V:.0102645,H:.0091776,F:.0089361,X:.0036228,J:0,K:0,W:0,Y:0,Z:0}},fractionatedMorseReplaces:["OOO","OO-","OOX","O-O","O--","O-X","OXO","OX-","OXX","-OO","-O-","-OX","--O","---","--X","-XO","-X-","-XX","XOO","XO-","XOX","X-O","X--","X-X","XXO","XX-"],testStrings:[],morbitReplaces:["OO","O-","OX","-O","--","-X","XO","X-","XX"],cipherWidth:1,charset:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",sourcecharset:"ABCDEFGHIJLMNOPQRSTUVWXYZ",unasigned:"",rowcharset:"",colcharset:"",replacement:[],curlang:"",holdupdates:!1,maxEncodeWidth:53,ShowRevReplace:!0,encodedString:"",Frequent:{},freq:[],chunkIt:!1,doEncoding:!0,affineCheck:{p:-1,q:-1,r:-1,s:-1,oldId:-1,olderId:-1},load:function(){},reset:function(){},findPossible:function(str){},setCharset:function(charset){this.charset=charset},isValidChar:function(char){return this.charset.indexOf(char)>=0},getCharset:function(){return this.charset},getSourceCharset:function(){return this.sourcecharset},normalizeHTML:function(str){return str},CalculateChiSquare:function(str){var charset=this.getCharset(),i,len;len=charset.length;var counts=new Array(len),total=0;for(i=0;i<len;i++)counts[i]=0;for(i=0;i<str.length;i++){var c=str.substr(i,1).toUpperCase(),pos=charset.indexOf(c);pos>=0&&(counts[pos]++,total++)}var chiSquare=0;for(i=0;i<len;i++){var c=charset.substr(i,1),expected=this.langfreq[this.lang][c];chiSquare+=Math.pow(counts[i]-total*expected,2)/(total*expected)}return chiSquare},createNormalFreqEditTable:function(){var table=$("<table/>").addClass("tfreq"),thead=$("<thead/>"),tbody=$("<tbody/>"),headrow=$("<tr/>"),freqrow=$("<tr/>"),replrow=$("<tr/>"),altreprow=$("<tr/>"),i,len,charset=this.getCharset();for(headrow.append($("<th/>").addClass("topleft")),freqrow.append($("<th/>").text("Frequency")),replrow.append($("<th/>").text("Replacement")),altreprow.append($("<th/>").text("Rev Replace")),i=0,len=charset.length;i<len;i++){var c=charset.substr(i,1).toUpperCase();headrow.append($("<th/>").text(c)),freqrow.append($('<td id="f'+c+'"/>'));var td=$("<td/>");td.append(this.makeFreqEditField(c)),replrow.append(td),altreprow.append($('<td id="rf'+c+'"/>'))}return thead.append(headrow),tbody.append(freqrow),tbody.append(replrow),this.ShowRevReplace&&tbody.append(altreprow),table.append(thead),table.append(tbody),table},createAlphabetType:function(){var res=$("<div>"),label=$("<label>",{for:"radios"}).text("Alphabet Type");res.append(label);var rbox=$("<div>",{id:"radios",class:"ibox"});rbox.append($("<input>",{id:"encrand",type:"radio",name:"enctype",value:"random",checked:"checked"})),rbox.append($("<label>",{for:"encrand",class:"rlab"}).text("Random")),rbox.append($("<input>",{id:"enck1",type:"radio",name:"enctype",value:"k1"})),rbox.append($("<label>",{for:"enck1",class:"rlab"}).text("K1")),rbox.append($("<input>",{id:"enck2",type:"radio",name:"enctype",value:"k2"})),rbox.append($("<label>",{for:"enck2",class:"rlab"}).text("K2")),rbox.append($("<input>",{id:"enck3",type:"radio",name:"enctype",value:"k3"})),rbox.append($("<label>",{for:"enck3",class:"rlab"}).text("K3")),rbox.append($("<input>",{id:"enck3",type:"radio",name:"enctype",value:"k4"})),rbox.append($("<label>",{for:"enck3",class:"rlab"}).text("K4")),res.append(rbox);var kval=$("<div>",{class:"kval"});kval.append($("<label>",{for:"keyword"}).text("Keyword")),kval.append($("<input>",{type:"text",id:"keyword"}));var odiv=$("<div>");odiv.append($("<label>",{for:"offset"}).text("Offset")),odiv.append($("<input>",{id:"offset",class:"inp spin",title:"offset",type:"text",value:"1"})),kval.append(odiv),res.append(kval);var k4val=$("<div>",{class:"k4val"});k4val.append($("<label>",{for:"keyword2"}).text("Keyword 2")),k4val.append($("<input>",{type:"text",id:"keyword2"}));var odiv2=$("<div>");odiv2.append($("<label>",{for:"offset2"}).text("Offset 2")),odiv2.append($("<input>",{id:"offset2",class:"inp spin",title:"offset",type:"text",value:"1"})),k4val.append(odiv2),res.append(k4val);var k3val=$("<div>",{class:"k3val"});return k3val.append($("<label>",{for:"shift"}).text("Shift")),k3val.append($("<input>",{id:"shift",class:"inp spin",title:"Shift",type:"text",value:"1"})),res.append(k3val),res.html()},setkvalinputs:function(){var val=$("input[name=enctype]:checked").val();"random"===val?$(".kval").hide():$(".kval").show(),"k3"===val?$(".k3val").show():$(".k3val").hide(),"k4"===val?$(".k4val").show():$(".k4val").hide()},isort:function(a,b){return a.freq>b.freq?-1:a.freq<b.freq?1:a.val<b.val?-1:a.val>b.val?1:0},makeTopList:function(string,width,num){var tfreq={},tobjs=[],work="",i,len,res="";for(i=0,len=string.length;i<len;i++){var t=string.substr(i,1).toUpperCase();this.isValidChar(t)&&(work+=t)}for(i=0,len=work.length;i<=len-width*this.cipherWidth;i++){var piece=work.substr(i,width*this.cipherWidth);isNaN(tfreq[piece])&&(tfreq[piece]=0),tfreq[piece]++}if(Object.keys(tfreq).forEach(function(value){var frequency=tfreq[value];if(frequency>1){var item={freq:frequency,val:value};tobjs.push(item)}}),tobjs.sort(this.isort),num>tobjs.length&&(num=tobjs.length),res="None found",num>0){for(res="<ul>",i=0;i<num;i++){var valtext=tobjs[i].val;if(this.cipherWidth>1){var vpos,vlen,extra="",final="";for(vpos=0,vlen=valtext.length/2;vpos<vlen;vpos++)final+=extra+valtext.substr(2*vpos,2),extra=" ";valtext=final}res+="<li>"+valtext+" - "+tobjs[i].freq+"</li>"}res+="</ul></div>"}return res},analyze:function(encoded,width,num){var res;return console.log("Analyze encoded="+encoded),'<table class="satable"><thead><tr><th>2 Characters</th><th>3 Characters</th><th>4 Characters</th><th>5 Characters</th></tr></thead><tbody><tr><td>'+this.makeTopList(encoded,2,12)+"</td><td>"+this.makeTopList(encoded,3,12)+"</td><td>"+this.makeTopList(encoded,4,12)+"</td><td>"+this.makeTopList(encoded,5,12)+"</td></tr></tbody></table>"},gcd:function(a,b){if(isNaN(a))return a;if(isNaN(b))return b;if(a<0&&(a=-a),b<0&&(b=-b),b>a){var temp=a;a=b,b=temp}for(;;){if(console.log("gcd a="+a+" b="+b),0==b)return a;if(0==(a%=b))return b;b%=a}},iscoprime:function(a){var charset=this.getCharset();console.log("iscoprime a="+a+" len="+charset.length);var gcdval=this.gcd(a,charset.length);return console.log("gcd("+a+","+charset.length+")="+gcdval),1==gcdval},affinechar:function(a,b,chr){var charset=this.getCharset(),x=charset.indexOf(chr.toUpperCase());if(x<0)return chr;var y=(a*x+b)%charset.length,res=charset.substr(y,1);return console.log("char="+chr+" x="+x+" a="+a+" b="+b+" y="+y+" res="+res),res},createAffineSolutionTable:function(){var table=$("<table/>").addClass("tfreq"),thead=$("<thead/>"),tbody=$("<tbody/>"),headrow=$("<tr/>"),freqrow=$("<tr/>"),replrow=$("<tr/>"),altreprow=$("<tr/>"),i,len,charset=this.getCharset();for(headrow.append($("<th/>").addClass("topleft")),freqrow.append($("<th/>").text("Frequency")),replrow.append($("<th/>").text("Replacement")),altreprow.append($("<th/>").text("Rev Replace")),i=0,len=charset.length;i<len;i++){var c=charset.substr(i,1).toUpperCase();headrow.append($("<th/>").text(c)),freqrow.append($('<td id="f'+c+'"/>'));var td=$("<td/>");td.append(this.makeFreqEditField(c)),replrow.append(td),altreprow.append($('<td id="rf'+c+'"/>'))}return thead.append(headrow),tbody.append(freqrow),tbody.append(replrow),this.ShowRevReplace&&tbody.append(altreprow),table.append(thead),table.append(tbody),table},buildSolver:function(str){var res="",combinedtext="",prehead='<div class="sword"><table class="tword"><tbody><tr>',posthead1='</tr></tbody></table><div class="repl" data-chars="',posthead2='"></div></div>',pre=prehead,post="",i,len,datachars="",charset=this.getCharset().toUpperCase();for(this.freq=[],i=0,len=charset.length;i<len;i++)this.freq[charset.substr(i,1).toUpperCase()]=0;for(i=0,len=str.length;i<len;i++){var t=str.substr(i,1).toUpperCase();this.isValidChar(t)?(isNaN(this.freq[t])&&(this.freq[t]=0),this.freq[t]++,datachars+=t,combinedtext+='<span data-char="'+t+'">?</span>',t=pre+'<td><div class="slil">'+t+'</div><input type="text" id="ti'+i+'" class="sli" data-char="'+t+'" /></td>',pre=""):" "===t||"\n"===t||"\r"===t?(t=""===pre?posthead1+datachars+posthead2:"",pre=prehead,datachars="",combinedtext+=" "):(combinedtext+=t,t=pre+'<td><div class="slil">'+t+"</div></td>",pre=""),res+=t}return""===pre&&(res+=posthead1+datachars+posthead2),res+='<div class="ssum">'+combinedtext+"</div>"},updateCheck:function(c,lock){this.morseLocked[c]!=lock&&(this.morseLocked[c]=lock,this.UpdateFreqEditTable(),this.load())},buildMorseSolver:function(str){var topdiv=$("<div/>").addClass("sword"),table=$("<table/>").addClass("mword"),tbody=$("<tbody/>"),inrow=$("<tr/>"),morserow=$("<tr/>"),outrow=$("<tr/>"),c,i,len,morseclass,remaining,lastsep="XX",extraout="",extralen=0,extraclass="",intext="",morsetext="",cipherwidth=this.cipherWidth,finaltext="",docwidth=$(document).width(),width=cipherwidth*Math.floor(docwidth/(24*cipherwidth));for(i=0,len=str.length;i<len;i++){var morsepiece;if(c=str.substr(i,1).toUpperCase(),this.isValidChar(c))intext+=c,morsetext+=(morsepiece=2===cipherwidth?this.morbitMap[c]+"????":this.fractionatedMorseMap[c]+"????").substr(0,cipherwidth)}for(morsetext+="XXX",remaining=width,i=0,len=intext.length;i<len;i++){var mpos,td;for(c=intext.substr(i,1),td=$("<td>",{colspan:cipherwidth}),this.morseLocked[c]&&td.addClass("locked"),td.text(c),inrow.append(td),mpos=0;mpos<cipherwidth;mpos++){var morse=morsetext.substr(i*cipherwidth+mpos,1);if(""===(morseclass=this.morsedigitClass[morse])&&(morseclass="error"),morse=this.normalizeHTML(morse),morserow.append($("<td/>").addClass(morseclass).html(morse)),extralen)extralen--;else{var startpos=i*cipherwidth+mpos,mlen=morsetext.indexOf("X",startpos)-startpos;if(0===mlen)console.log("Empty Morse laststep="+lastsep),""===lastsep?(outrow.append($("<td/>").addClass("null")),lastsep="X"):"X"===lastsep?(outrow.append($("<td/>").addClass("space")),lastsep="XX",finaltext+=" "):(outrow.append($("<td/>").addClass("error")),finaltext+='<span class="error">?</span>');else{var morselet=morsetext.substr(startpos,mlen);console.log("Moreselet:"+morselet+"len="+mlen+" remaining="+remaining+" mpos="+mpos+" Cipherwidth="+cipherwidth),lastsep="";var outchar="";void 0===this.frommorse[morselet]?(morseclass="error",outchar="??",finaltext+='<span class="error">?</span>'):(outchar=this.frommorse[morselet],morseclass=this.morseClass[outchar],finaltext+=outchar),extralen=mlen-1,mlen<=remaining?outrow.append($('<td colspan="'+mlen+'"/>').addClass(morseclass).text(outchar)):2*remaining>=mlen?(outrow.append($('<td colspan="'+remaining+'"/>').addClass(morseclass).text(outchar)),extraout="",extraclass="cont"):(outrow.append($('<td colspan="'+remaining+'"/>').addClass("cont")),extraout=outchar,extraclass=morseclass)}}remaining--}remaining<=0&&(tbody.append(inrow),tbody.append(morserow),tbody.append(outrow),table.append(tbody),topdiv.append(table),table=$("<table/>").addClass("mword"),tbody=$("<tbody/>"),inrow=$("<tr/>"),morserow=$("<tr/>"),outrow=$("<tr/>"),extralen>0&&outrow.append($('<td colspan="'+extralen+'"/>').addClass(extraclass).text(extraout)),remaining=width)}return tbody.append(inrow),tbody.append(morserow),tbody.append(outrow),table.append(tbody),topdiv.append(table),topdiv.append($("<hr/><div>"+finaltext+"</div>")),topdiv},createMorseFreqEditTable:function(){var table=$("<table/>").addClass("tfreq"),thead=$("<thead/>"),tbody=$("<tbody/>"),headrow=$("<tr/>"),freqrow=$("<tr/>"),replrow=$("<tr/>"),lockrow=$("<tr/>"),i,len,charset=this.getCharset();for(headrow.append($("<th/>").addClass("topleft")),freqrow.append($("<th/>").text("Frequency")),replrow.append($("<th/>").text("Replacement")),lockrow.append($("<th/>").text("Locked")),i=0,len=charset.length;i<len;i++){var c=charset.substr(i,1).toUpperCase();headrow.append($("<th/>").text(c)),freqrow.append($('<td id="f'+c+'"/>'));var td=$("<td/>");td.append(this.makeFreqEditField(c)),replrow.append(td),td=$("<td/>");var ischecked=this.morseLocked[c];$("<input />",{type:"checkbox",class:"cb","data-char":c,id:"cb"+c,value:name,checked:ischecked}).appendTo(td),lockrow.append(td)}return thead.append(headrow),tbody.append(freqrow),tbody.append(replrow),tbody.append(lockrow),table.append(thead),table.append(tbody),table},cacheReplacements:function(){for(var charset=this.getCharset().toUpperCase(),i=0,len=charset.length;i<len;i++){var c=charset.substr(i,1),repl=$("#m"+c).val();""===repl&&(repl=$("#m"+c).text()),this.replacement[c]=repl,$("#rf"+repl).text(c)}},setStandardChar:function(repchar,newchar){this.replacement[repchar]=newchar,$("input[data-char='"+repchar+"']").val(newchar),""===newchar&&(newchar="?"),$("span[data-char='"+repchar+"']").text(newchar),this.cacheReplacements(),this.updateMatchDropdowns(repchar)},setStandardMultiChars:function(reqstr){var i,len;for(console.log("setStandardMultiChars "+reqstr),this.holdupdates=!0,i=0,len=reqstr.length/2;i<len;i++){var repchar=reqstr.substr(2*i,1),newchar=reqstr.substr(2*i+1,this.cipherWidth);console.log("Set "+repchar+" to "+newchar),this.updateSel(repchar,newchar)}this.holdupdates=!1,this.updateMatchDropdowns("")},cleanString:function(str){var pattern,re=new RegExp("[\r\n ]+","g");return str.replace(re," "),str},minimizeString:function(str){for(var res="",i=0,len=str.length;i<len;i++){var c=str.substr(i,1).toUpperCase();this.isValidChar(c)&&(res+=c)}return res},attachHandlers:function(){var tool=this;$(".sli").keyup(function(event){var newchar,repchar=$(event.target).attr("data-char"),current,next,focusables=$(".sli");37===event.keyCode?(next=0===(current=focusables.index(event.target))?focusables.last():focusables.eq(current-1)).focus():39===event.keyCode?(current=focusables.index(event.target),(next=focusables.eq(current+1).length?focusables.eq(current+1):focusables.eq(0)).focus()):46!==event.keyCode&&8!==event.keyCode||tool.setChar(repchar,""),event.preventDefault()}).keypress(function(event){var newchar,repchar=$(event.target).attr("data-char"),current,next,focusables=$(".sli");newchar=void 0===event.key?String.fromCharCode(event.keyCode).toUpperCase():event.key.toUpperCase(),tool.isValidChar(newchar)||" "===newchar?(" "===newchar&&(newchar=""),console.log("Setting "+repchar+" to "+newchar),tool.setChar(repchar,newchar),current=focusables.index(event.target),(next=focusables.eq(current+1).length?focusables.eq(current+1):focusables.eq(0)).focus()):console.log("Not valid:"+newchar),event.preventDefault()}).blur(function(){var tohighlight=$(this).attr("data-char");$("[data-char='"+tohighlight+"']").removeClass("allfocus");var althighlight=$(this).attr("data-schar");""!==althighlight&&$("[data-schar='"+althighlight+"']").removeClass("allfocus"),$(this).removeClass("focus")}).focus(function(){var tohighlight=$(this).attr("data-char");$("[data-char='"+tohighlight+"']").addClass("allfocus");var althighlight=$(this).attr("data-schar");""!==althighlight&&$("[data-schar='"+althighlight+"']").addClass("allfocus"),$(this).addClass("focus")}),$(".cb").on("change",function(){var toupdate=$(this).attr("data-char");tool.updateCheck(toupdate,$(this).prop("checked"))}),$(".msli").on("change",function(){var toupdate=$(this).attr("data-char");tool.updateSel(toupdate,this.value)}),$("#rowcharset").on("change",function(){tool.setrowcolset(this.value,tool.colcharset,!0)}),$("#colcharset").on("change",function(){tool.setrowcolset(tool.rowcharset,this.value,!0)}),$(".spin").spinner({spin:function(event,ui){return ui.value>=tool.getCharset().length?($(this).spinner("value",0),!1):ui.value<0?($(this).spinner("value",tool.getCharset().length-1),!1):void 0}}),$(".richtext").summernote({fontNames:["Arial","Courier New"],toolbar:[["style",["bold","italic","underline","clear"]],["font",["fontname","superscript","subscript"]],["fontsize",["fontsize"]]]}),$("input[type=radio][name=enctype]").change(function(){tool.setkvalinputs()}),$("input[type=radio][name=operation]").change(function(){tool.setVigenereInputs()}),tool.setkvalinputs()},displayFreq:function(){var charset=this.getCharset(),c,i,len;for(c in this.holdupdates=!0,this.freq)if(this.freq.hasOwnProperty(c)){var subval=this.freq[c];0===subval&&(subval=""),$("#f"+c).text(subval)}if(this.ShowRevReplace)for(i=0,len=charset.length;i<len;i++){c=charset.substr(i,1);var repl=$("#m"+c).val();""===repl&&(repl=$("#m"+c).html()),this.setChar(c,repl)}this.holdupdates=!1,this.updateMatchDropdowns("")},makeUniquePattern:function(str,width){var cmap={},res="",mapval=0,i,len,c;for(len=str.length,str+="XXXX",i=0;i<len;i+=width)void 0===cmap[c=str.substr(i,width)]&&(cmap[c]=""+mapval,mapval++),res+=cmap[c];return res},searchPattern:function(encoded,encodewidth,tofind,findwidth){var res="",notmapped="????".substr(0,findwidth),searchstr=this.makeUniquePattern(tofind,findwidth),i,len;findwidth>1&&(tofind+="XXXX".substr(0,findwidth-tofind.length%findwidth));var searchlen=searchstr.length,encrlen=encoded.length,used=[],charset=this.getCharset().toUpperCase();for(i=0,len=charset.length;i<len;i++)used[charset.substr(i,1)]=!1;for(i=0,len=charset.length;i<len;i++)used[this.replacement[charset.substr(i,1)]]=!0;for(i=0;i+searchlen*encodewidth<=encrlen;i+=encodewidth){var checkstr=encoded.substr(i,searchlen*encodewidth),check;if(this.makeUniquePattern(checkstr,encodewidth)===searchstr){var keymap={},j,matched;for(matched=!0,j=0;j<charset.length;j++)keymap[charset.substr(j,1)]=notmapped;for(j=0;j<searchlen;j++){var keystr=tofind.substr(j*findwidth,findwidth);keymap[checkstr.substr(j,1)]=keystr,1==findwidth&&keystr===checkstr.substr(j,1)&&(matched=!1)}if(findwidth>1){if(i>0&&"X"!==tofind.substr(0,1)){var preceeding=encoded.substr(i-1,1),prevchar=keymap[preceeding].substr(findwidth-1,1);"X"!==prevchar&&"?"!==prevchar&&(console.log("*** Disallowing "+checkstr+" because prevchar ="+prevchar+" for "+preceeding),matched=!1)}if(matched&&"X"!==tofind.substr(tofind.length-1,1)&&i+searchlen<encrlen){var following=encoded.substr(i+searchlen,1),nextchar=keymap[following].substr(0,1);"X"!==nextchar&&"?"!==prevchar&&(console.log("*** Disallowing "+checkstr+" because nextchar ="+nextchar+" for "+following),matched=!1)}}else{var repl=this.genReplPattern(checkstr);this.isValidReplacement(tofind,repl,used)||(matched=!1)}if(matched){var maptable="",mapfix="";for(j=0;j<charset.length;j++){var key=charset.substr(j,1);maptable+="<td>"+this.normalizeHTML(keymap[key])+"</td>",keymap[key]!==notmapped&&(mapfix+=key+keymap[key])}res+="<tr><td>"+i+'</td><td><a class="dapply" href="#" onclick="CipherTool.setMultiChars(\''+mapfix+"');\">"+checkstr+"</a></td>"+maptable+"</tr>"}}}return res},setMorseMultiChars:function(reqstr){var i,len;for(console.log("setMorseMultiChars "+reqstr),this.holdupdates=!0,i=0,len=reqstr.length/(this.cipherWidth+1);i<len;i++){var repchar=reqstr.substr(i*(this.cipherWidth+1),1),newchar=reqstr.substr(i*(this.cipherWidth+1)+1,this.cipherWidth);console.log("Set "+repchar+" to "+newchar),this.updateSel(repchar,newchar)}this.holdupdates=!1,this.updateMatchDropdowns("")},applyReplPattern:function(str,repl){var i,len,res="";for(len=str.length,i=0;i<len;i++){var c=repl.substr(i,1);" "===c&&(c=str.substr(i,1)),res+=c}return res},genReplPattern:function(str){var i,len,res=[];for(i=0,len=str.length;i<len;i++){var c=str.substr(i,1);res.push(this.replacement[c])}return res},isValidReplacement:function(str,repl,used){var i,len;for(i=0,len=str.length;i<len;i++){var c=str.substr(i,1);if(""!==repl[i]){if(c!==repl[i])return!1}else if(used[c])return!1}return!0},generateMatchDropdown:function(str){if(""===this.curlang)return"";var pat=this.makeUniquePattern(str,1),repl=this.genReplPattern(str),mselect=$("<select/>").addClass("match");if(void 0!==this.Frequent[this.curlang][pat]){var matches=this.Frequent[this.curlang][pat],selectclass="",matched=!1,added=0,i,len,used=[],charset=this.getCharset().toUpperCase();for(i=0,len=charset.length;i<len;i++)used[charset.substr(i,1)]=!1;for(i=0,len=charset.length;i<len;i++)used[this.replacement[charset.substr(i,1)]]=!0;for(i=0,len=matches.length;i<len;i++){var entry=matches[i];if(this.isValidReplacement(entry[0],repl,used)&&(matched||(selectclass="l"+entry[3]),matched=!0,added++,$("<option/>").addClass("l"+entry[3]).text(entry[0]).appendTo(mselect)),matched&&added>9)break}0===added&&(selectclass="nopat"),mselect.addClass(selectclass)}else mselect.addClass("nopat");return mselect},updateStandardMatchDropdowns:function(repchar){var tool=this;this.cacheReplacements(),$("[data-chars]").each(function(){$(this).html(tool.generateMatchDropdown($(this).attr("data-chars")))})},loadSolver:function(){var encoded=this.cleanString($("#encoded").val());console.log("LoadSolver");var res=this.build(encoded),tool=this;$("#answer").html(res),$("#analysis").each(function(i){$(this).html(tool.analyze(encoded))}),this.displayFreq(),this.attachHandlers()},resetSolver:function(){for(var c in this.morseLocked={},this.freq)this.freq.hasOwnProperty(c)&&($("#m"+c).val(""),$("#rf"+c).text(""));this.load()},findStandard:function(str){var encoded=this.minimizeString($("#encoded").val()),extra="",res="",i;if(str=str.toUpperCase(),""===(res=this.searchPattern(encoded,1,str,1)))res="<br/><b>Not Found</b>";else{var charset=this.getCharset(),tres='<table class="mfind"><thead><tr><th>Pos</th><th>Match</th>';for(i=0;i<charset.length;i++){var key;tres+="<th>"+charset.substr(i,1)+"</th>"}res=tres+"</tr></thead><tbody>"+res+"</tbody></table>"}$(".findres").html("Searching for "+str+" as "+this.normalizeHTML(str)+res)},makeEditField:function(c){var einput;return $("<input/>",{type:"text",class:"sli","data-char":c,id:"m"+c})},makeViewField:function(c){var einput;return $("<span/>",{type:"text","data-char":c,id:"m"+c})},updateStandardSel:function(item,val){this.setChar(item,val)},init:function(){},findMorse:function(str){for(var encoded=this.minimizeString($("#encoded").val()),morse="",extra="",res="",i=0,len=str.length;i<len;i++){var c=str.substr(i,1).toUpperCase();void 0!==this.tomorse[c]&&(morse+=extra+this.tomorse[c],extra="X")}for(i=0;i<this.cipherWidth;i++)res+=this.searchPattern(encoded,1,"XXXXX".substr(0,i)+morse,this.cipherWidth);if(""===res)res="<br/><b>Not Found</b>";else{var charset=this.getCharset(),tres='<table class="mfind"><thead><tr><th>Pos</th><th>Match</th>';for(i=0;i<charset.length;i++){var key;tres+="<th>"+charset.substr(i,1)+"</th>"}res=tres+"</tr></thead><tbody>"+res+"</tbody></table>"}$(".findres").html("Searching for "+str+" as "+this.normalizeHTML(morse)+res)},normalizeMorseHTML:function(str){return str.replace(/O/g,"&#9679;").replace(/-/g,"&ndash;").replace(/X/g,"&times;")},initMorbitSolver:function(){this.cipherWidth=2,this.setCharset("123456789")},getMorbitMorseMap:function(){return this.morbitMap},setMorbitMorseMapEntry:function(entry,val){this.morbitMap[entry]=val},loadMorseSolver:function(){this.encodedString=this.cleanString($("#encoded").val());var res=this.build(this.encodedString),tool=this;$("#answer").html(res),$("#analysis").each(function(i){$(this).html(tool.analyze(tool.encodedString))}),this.displayFreq(),this.attachHandlers()},makeMorbitEditField:function(c){var mselect=$('<select class="msli" data-char="'+c+'" id="m'+c+'"/>'),mreplaces=this.morbitReplaces.length,charset=this.getCharset(),selected=[];selected[this.morbitMap[c]]=" selected";for(var i=0;i<mreplaces;i++){var text=this.morbitReplaces[i];$("<option />",{value:i,selected:selected[text]}).html(this.normalizeHTML(text)).appendTo(mselect)}return mselect},updateMorbitSel:function(item,val){console.log("updateMorbitSet item="+item+" val="+val);var toswapwith=item,newvalue=this.morbitReplaces[val];for(var key in this.morbitMap)if(this.morbitMap.hasOwnProperty(key)&&this.morbitMap[key]===newvalue){toswapwith=key;break}if(toswapwith!==item){var swapval=this.morbitMap[item];this.morbitMap[item]=this.morbitMap[toswapwith],this.morbitMap[toswapwith]=swapval,this.UpdateFreqEditTable(),this.load()}},initFractionatedMorseSolver:function(){this.cipherWidth=3,this.setCharset("ABCDEFGHIJKLMNOPQRSTUVWXYZ")},getFractionatedMorseMap:function(){return this.fractionatedMorseMap},setFractionatedMorseMapEntry:function(entry,val){this.fractionatedMorseMap[entry]=val},makeFractionatedMorseEditField:function(c){if(this.morseLocked[c])return this.normalizeHTML(this.fractionatedMorseMap[c]);var mselect=$('<select class="msli" data-char="'+c+'" id="m'+c+'"/>'),locklist={};for(var key in this.morseLocked)this.morseLocked.hasOwnProperty(key)&&this.morseLocked[key]&&(locklist[this.fractionatedMorseMap[key]]=!0,console.log("Recording locklist["+key+"]="+locklist[key]));var mreplaces=this.fractionatedMorseReplaces.length,selected=[];selected[this.fractionatedMorseMap[c]]=" selected";for(var i=0;i<mreplaces;i++){var text=this.fractionatedMorseReplaces[i];console.log("Checkign for "+text),locklist[text]||$("<option />",{value:text,selected:selected[text]}).html(this.normalizeHTML(text)).appendTo(mselect)}return mselect},updateFractionatedMorseSel:function(item,val){console.log("updateFractionatedMorseSel item="+item+" val="+val);var toswapwith=item;for(var key in this.fractionatedMorseMap)if(this.fractionatedMorseMap.hasOwnProperty(key)&&this.fractionatedMorseMap[key]===val){toswapwith=key;break}if(toswapwith!==item){var swapval=this.fractionatedMorseMap[item];this.fractionatedMorseMap[item]=this.fractionatedMorseMap[toswapwith],this.fractionatedMorseMap[toswapwith]=swapval,this.UpdateFreqEditTable(),this.load()}},updateCheckerboardSel:function(){this.UpdateFreqEditTable()},UpdateFreqEditTable:function(){var tool=this;$(".freq").each(function(i){$(this).html(tool.createFreqEditTable())}),$(".alphabet").each(function(i){$(this).html(tool.createAlphabetType())}),this.attachHandlers()},setCipherType:function(cipherType){"patristocrat"==cipherType?(console.log(cipherType+" -- set chunking."),this.chunkIt=!0):"vigenere"===cipherType&&(console.log("Make a nice vigenere..."),$(".cipher-type").each(function(){$(this).html(CipherTool.layoutVigenere())}),this.attachHandlers())},initGromarkSolver:function(){this.cipherWidth=2},buildGromarkSolver:function(str){var res="",combinedtext="",prehead='<div class="sword"><table class="tword"><tbody><tr>',posthead1='</tr></tbody></table><div class="repl" data-chars="',posthead2='"></div></div>',pre=prehead,post="",i,len,c,piece,datachars,offsets=[],offpos=0,docwidth=$(document).width(),width,remaining=Math.floor(docwidth/24),finalcheck=99,charset=this.getCharset().toUpperCase();for(this.freq=[],this.encodedString="",i=0,len=(str=str.replace(/\s+/g," ")).length;i<len;i++){if(" "!==(c=str.substr(i,1))){if(isNaN(c))return'<div class="error">Gromark must start with 5 numeric digits - found '+c+"</div>";offsets[offpos++]=parseInt(c,10)}if(offpos>=5){str=str.substr(i,len-1);break}}for(i=str.length-1;i>0;i--)if(" "!==(c=str.substr(i,1))){if(!isNaN(c)){finalcheck=parseInt(c,10),str=str.substr(1,i-1);break}return'<div class="error">Gromark must end with single numeric check digit - found '+c+"</div>"}for(str=str.replace(/^\s+|\s+$/g,""),offpos=-1,datachars="",this.encodedString="",i=0,len=str.length;i<len;i++)c=str.substr(i,1).toUpperCase(),this.isValidChar(c)?(++offpos>=5&&(offsets[offpos]=(offsets[offpos-5]+offsets[offpos-4])%10),piece=c+offsets[offpos],this.encodedString+=piece,datachars+=piece,isNaN(this.freq[piece])&&(this.freq[piece]=0),this.freq[piece]++,isNaN(this.freq[c])&&(this.freq[c]=0),this.freq[c]++,combinedtext+='<span data-char="'+piece+'">?</span>',c=pre+'<td><div class="slil">'+c+"<br/>"+offsets[offpos]+'</div><input type="text" id="ti'+piece+'" class="sli" data-schar="'+c+'" data-char="'+piece+'" /></td>',pre=""):" "!==c?(combinedtext+=c,c=pre+'<td><div class="slil">'+c+"</div></td>",pre=""):(combinedtext+=" ",res+=posthead1+datachars+posthead2,datachars="",pre=prehead),res+=c;return""===pre&&(res+=posthead1+datachars+posthead2),res+='<div class="ssum">'+combinedtext+"</div>"},createGromarkFreqEditTable:function(){var topdiv=$("<div/>"),table=$("<table/>").addClass("tfreq"),thead=$("<thead/>"),tbody=$("<tbody/>"),headrow=$("<tr/>"),freqrow,replrow=$("<tr/>"),i,len,n,c,charset=this.getCharset();for(headrow.append($("<th/>").addClass("topleft")),n=0;n<=9;n++){for((freqrow=$("<tr/>")).append($("<th/>").text(n)),i=0,len=charset.length;i<len;i++)c=charset.substr(i,1).toUpperCase(),0===n&&headrow.append($("<th/>").text(c)),freqrow.append($('<td id="f'+c+n+'"/>'));0===n&&thead.append(headrow),thead.append(freqrow)}for((headrow=$("<tr/>")).append($("<th/>").addClass("topleft")),(freqrow=$("<tr/>")).append($("<th/>").text("Frequency")),replrow.append($("<th/>").text("Replacement")),i=0,len=charset.length;i<len;i++){c=charset.substr(i,1).toUpperCase(),headrow.append($("<th/>").text(c)),freqrow.append($('<td id="f'+c+'"/>'));var td=$("<td/>");td.append(this.makeFreqEditField(c)),replrow.append(td)}return thead.append(headrow),tbody.append(freqrow),tbody.append(replrow),table.append(thead),table.append(tbody),topdiv.append(table),topdiv},setGromarkChar:function(repchar,newchar){if(void 0!==newchar){var charset=this.getSourceCharset();if(repchar.length>1){var targetc=newchar;newchar=repchar.substr(0,1);var roff=parseInt(repchar.substr(1,1),10);repchar=(charset+charset).substr(charset.indexOf(targetc)+roff,1)}var dispchar=newchar=newchar.toUpperCase(),fillchar=newchar,pos=charset.indexOf(repchar);if(""===dispchar&&(dispchar="?",fillchar=this.replacement[repchar]),this.replacement[repchar]=newchar,pos>=0){pos+=charset.length,charset+=charset,$("input[data-char='"+repchar+"']").val(newchar),$("#f"+repchar).text(dispchar);for(var i=0;i<=9;i++){var repl="";""!==newchar&&(repl=charset.substr(pos-i,1)),""===(dispchar=repl)&&(dispchar="?");var piece=fillchar+i;$("input[data-char='"+piece+"']").val(repl),$("span[data-char='"+piece+"']").text(dispchar)}this.updateMatchDropdowns(repchar)}}},setGromarkMultiChars:function(reqstr){var i,len;for(this.holdupdates=!0,i=0,len=reqstr.length/2;i<len;i++){var repchar=reqstr.substr(2*i,1),newchar=reqstr.substr(2*i+1,1);this.setGromarkChar(repchar,newchar)}this.holdupdates=!1,this.updateMatchDropdowns("")},gmsort:function(a,b){return a.o<b.o?-1:a.o>b.o?1:0},generateGromarkDropdown:function(str){if(""===this.curlang)return"";var i,len,matchstr="",keepadding=!0,repl=[],matches=[],used=[],slen=str.length/this.cipherWidth;for(i=0;i<slen;i++){var piece=str.substr(i*this.cipherWidth,this.cipherWidth),substitute="";void 0===this.gromarkRepl[piece]?keepadding=!1:substitute=this.gromarkRepl[piece],keepadding&&(matchstr+=substitute),repl.push(substitute)}var pat=this.makeUniquePattern(matchstr),patlen=pat.length;for(var tpat in this.Frequent[this.curlang])if(this.Frequent[this.curlang].hasOwnProperty(tpat)&&tpat.length===slen&&tpat.substr(0,patlen)===pat){var tmatches=this.Frequent[this.curlang][tpat],added=0;for(i=0,len=tmatches.length;i<len;i++){var entry=tmatches[i];if(this.isValidReplacement(entry[0],repl,used)&&(matches.push(entry),++added>3))break}}matches.sort(this.gmsort);var mselect=$("<select/>").addClass("match");if(matches.length>0){var selectclass="",matched=!1,added=0;for(i=0,len=matches.length;i<len;i++){var entry=matches[i];if(this.isValidReplacement(entry.t,repl,used)&&(matched||(selectclass=entry.c),matched=!0,added++,$("<option/>").addClass(entry.c).text(entry.t).appendTo(mselect)),matched&&added>9)break}0===added&&(selectclass="nopat"),mselect.addClass(selectclass)}else mselect.addClass("nopat");return mselect},updateGromarkMatchDropdowns:function(repchar){var tool=this;this.holdupdates||(this.cacheReplacements(),this.saveGromarkReplacements(),$("[data-chars]").each(function(){$(this).html(tool.generateGromarkDropdown($(this).attr("data-chars")))}))},saveGromarkReplacements:function(){var i,n,len,charset;for(this.gromarkRepl=[],len=(charset=this.getSourceCharset()).length,charset+=charset,i=0;i<len;i++){var c=charset.substr(i,1),repl=this.replacement[c];if(this.isValidChar(repl))for(n=0;n<=9;n++){var decodc=charset.substr(len+i-n,1);this.gromarkRepl[repl+n]=decodc}}},makeGromarkMap:function(str,gromark){var i,len,charset=this.getSourceCharset(),res={};for(i=0,len=charset.length;i<len;i++)res[charset.substr(i,1)]="";for(charset+=charset,i=0,len=str.length;i<len;i++){var c=str.substr(i,1),piece=gromark.substr(i*this.cipherWidth,this.cipherWidth),offset=charset.indexOf(c)+parseInt(piece.substr(1,1),10),repl=piece.substr(0,1);res[charset.substr(offset,1)]=repl}return res},checkGromark:function(tomatch,gromark){if(tomatch.length*this.cipherWidth!=gromark.length)return console.log('Invalid check comparing "'+tomatch+'"('+tomatch.length+') against "'+gromark+'"('+gromark.length+")"),0;var i,len,charset=this.getSourceCharset(),sets={},matchlevel=1;for(i=0;i<tomatch.length;i++){var c=tomatch.substr(i,1),piece=gromark.substr(i*this.cipherWidth,this.cipherWidth);if(void 0!==this.gromarkRepl[piece]&&this.gromarkRepl[piece]!==c)return 0;var offset=parseInt(piece.substr(1,1),10),repl=piece.substr(0,1);if(void 0!==sets[offset+=charset.indexOf(c)]){if(sets[offset]!=repl)return 0;matchlevel=2}if(void 0!==sets[repl]){if(sets[repl]!=offset)return 0;matchlevel=2}sets[repl]=offset,sets[offset]=repl}return matchlevel},findGromark:function(str){var tosearch=this.minimizeString(str),gromarklen=tosearch.length*this.cipherWidth,limit=this.encodedString.length/this.cipherWidth-tosearch.length,charset=this.getSourceCharset(),len=charset.length,i,j,res="";for(this.saveGromarkReplacements(),i=0;i<limit;i++){var gromark=this.encodedString.substr(i*this.cipherWidth,gromarklen),matchlevel=this.checkGromark(tosearch,gromark);if(matchlevel>0){var mappings=this.makeGromarkMap(tosearch,gromark),maptable="",mapfix="";for(j=0;j<len;j++){var c=charset.substr(j,1),mapc=mappings[c];maptable+="<td>"+mapc+"</td>",""!==mapc&&(mapfix+=c+mapc)}res+="<tr><td>"+i+"</td><td>"+matchlevel+'</td><td class="dapply" onclick="CipherTool.setMultiChars(\''+mapfix+"');\">"+gromark+"</td>"+maptable+"</tr>"}}if(""===res)res="<br/><b>Not Found</b>";else{var tres='<table class="mfind"><thead><tr><th>Pos</th><th>Type</th><th>Gromark</th>';for(i=0;i<len;i++)tres+="<th>"+charset.substr(i,1)+"</th>";res=tres+"</tr></thead><tbody>"+res+"</tbody></table>"}$(".findres").html("Searching for "+str+res),this.attachHandlers()},initCheckerboardSolver:function(){this.cipherWidth=2,this.rowcharset="     ",this.colcharset="     "},setrowcolset:function(rowcharset,colcharset,forceorder){var changed=!1,i,len,c;if(rowcharset=rowcharset.toUpperCase(),colcharset=colcharset.toUpperCase(),this.rowcharset=this.rowcharset.trim(),this.colcharset=this.colcharset.trim(),rowcharset!==this.rowcharset)if(forceorder)changed=!0,this.rowcharset=rowcharset;else for(i=0,len=rowcharset.length;i<len;i++)c=rowcharset.substr(i,1),this.rowcharset.indexOf(c)<0&&(this.rowcharset+=c,changed=!0);if(colcharset!==this.colcharset)if(forceorder)changed=!0,this.colcharset=colcharset;else for(i=0,len=colcharset.length;i<len;i++)c=colcharset.substr(i,1),this.colcharset.indexOf(c)<0&&(this.colcharset+=c,changed=!0);this.rowcharset.length<5&&(this.rowcharset+="     ".substr(0,5-this.rowcharset.length)),this.colcharset.length<5&&(this.colcharset+="     ".substr(0,5-this.colcharset.length)),changed&&(this.UpdateFreqEditTable(),this.load())},buildCheckerboardSolver:function(str){var res="",combinedtext="",prehead='<div class="sword"><table class="tword"><tbody><tr>',posthead="</tr></tbody></table></div>",pre=prehead,post="",i,len,firstchar="",firstset="",secondset="",docwidth=$(document).width(),width=Math.floor(docwidth/24),remaining=width,charset=this.getCharset().toUpperCase();for(this.freq=[],i=0,len=str.length;i<len;i++){var t=str.substr(i,1).toUpperCase();if(this.isValidChar(t))if(""===firstchar)firstchar=t,firstset.indexOf(t)<0&&(firstset+=t),t="";else{var piece=firstchar+t;secondset.indexOf(t)<0&&(secondset+=t),isNaN(this.freq[piece])&&(this.freq[piece]=0),this.freq[piece]++,combinedtext+='<span data-char="'+piece+'">?</span>',t=pre+'<td><div class="slil">'+firstchar+"<br/>"+t+'</div><input type="text" id="ti'+piece+'" class="sli" data-char="'+piece+'" /></td>',pre="",remaining--,firstchar=""}else" "!==t&&"\n"!==t&&"\r"!==t&&(combinedtext+=t,t=pre+'<td><div class="slil">'+t+"</div></td>",pre="");res+=t,0===remaining&&(res+=posthead,pre=prehead,remaining=width)}return""===pre&&(res+=posthead),res+='<div class="ssum">'+combinedtext+"</div>",this.setrowcolset(firstset,secondset,!1),res},createCheckerboardFreqEditTable:function(){var topdiv=$("<div/>"),inputdiv=$("<div/>",{class:"idiv"}),table=$("<table/>").addClass("ckfreq"),thead=$("<thead/>"),tbody=$("<tbody/>"),headrow=$("<tr/>"),row,rowlen,col,collen;for(rowlen=this.rowcharset.length,collen=this.colcharset.length,headrow.append($("<th/>").addClass("topleft")),col=0;col<collen;col++)headrow.append($("<th/>").text(this.colcharset.substr(col,1).toUpperCase()));for(thead.append(headrow),inputdiv.append($("<label/>",{for:"rowcharset",text:"Row Characters"})),inputdiv.append($("<input/>",{type:"text",class:"csc",id:"rowcharset",value:this.rowcharset})),inputdiv.append($("<label/>",{for:"colcharset",text:"Column Characters"})),inputdiv.append($("<input/>",{type:"text",class:"csc",id:"colcharset",value:this.colcharset})),topdiv.append(inputdiv),row=0;row<rowlen;row++){var replrow=$("<tr/>"),rowc=this.rowcharset.substr(row,1).toUpperCase();for(replrow.append($("<th/>").text(rowc)),col=0;col<collen;col++){var colc,piece=rowc+this.colcharset.substr(col,1).toUpperCase(),freq=this.freq[piece],td,input;void 0===freq&&(freq=""),(td=$("<td/>").text(freq)).append($("</br>")),td.append(this.makeFreqEditField(piece)),replrow.append(td)}tbody.append(replrow)}return table.append(thead),table.append(tbody),topdiv.append(table),topdiv},loadCheckerboardSolver:function(){var encoded=this.cleanString($("#encoded").val()),res=this.build(encoded),tool=this;$("#answer").html(res),$("#analysis").each(function(i){$(this).html(tool.analyze(encoded))}),this.UpdateFreqEditTable(),this.displayFreq(),this.attachHandlers()},findCheckerboard:function(str){var encoded=this.minimizeString($("#encoded").val()),extra="",res="",i;if(str=str.toUpperCase(),""===(res=this.searchPattern(encoded,this.cipherWidth,str,1)))res="<br/><b>Not Found</b>";else{var charset=this.getCharset(),tres='<table class="mfind"><thead><tr><th>Pos</th><th>Match</th>';for(i=0;i<charset.length;i++){var key;tres+="<th>"+charset.substr(i,1)+"</th>"}res=tres+"</tr></thead><tbody>"+res+"</tbody></table>"}$(".findres").html("Searching for "+str+" as "+this.normalizeHTML(str)+res)},quote:function(str){return void 0===str?"''":"'"+str.replace(/(['"])/g,"\\$1")+"'"},dumpLang:function(lang){var res="",extra="";for(var pat in res="CipherTool.Frequent["+this.quote(lang)+"]={",this.Frequent[lang])if(this.Frequent[lang].hasOwnProperty(pat)&&""!==pat){var i,len;res+=extra+"'"+pat+"':[";var extra1="",matches=this.Frequent[lang][pat];for(i=0,len=matches.length;i<len;i++)res+=extra1+"["+this.quote(matches[i][0])+","+matches[i][1]+","+matches[i][2]+","+matches[i][3]+"]",extra1=",";res+="]",extra=","}return res+="};"},setLangDropdown:function(lselect){for(var lang in lselect.html($("<option />",{value:""}).text("--Select a language--")),this.langmap)this.langmap.hasOwnProperty(lang)&&$("<option />",{value:lang}).text(this.langmap[lang]).appendTo(lselect);var tool=this;lselect.change(function(){tool.loadLanguage($(this).val())})},loadLanguage:function(lang){var tool=this;$(".langstatus").text("Attempting to load "+tool.langmap[lang]+"..."),$.getScript("Languages/"+lang+".js",function(data,textStatus,jqxhr){$(".langstatus").text(""),tool.curlang=lang,tool.setCharset(tool.langcharset[lang]),tool.updateMatchDropdowns("")}).fail(function(jqxhr,settings,exception){console.log("Complied language file not found for "+lang+".js"),tool.loadRawLanguage(lang)})},loadRawLanguage:function(lang){var tool=this,jqxhr=$.get("Languages/"+lang+".txt",function(){}).done(function(data){$(".langstatus").text("Processing "+tool.langmap[lang]+"..."),tool.Frequent[lang]={},tool.curlang=lang;var charset=tool.langcharset[lang],langreplace=tool.langreplace[lang];tool.setCharset(charset);var lines=data.split("\n"),i,len;for(len=lines.length,charset=charset.toUpperCase(),i=0;i<len;i++){for(var pieces=lines[i].replace(/\r/g," ").toUpperCase().split(/ /),legal=!0,j=0;j<pieces[0].length;j++)if(charset.indexOf(pieces[0][j])<0){if(void 0===langreplace[pieces[0][j]]){console.log("skipping out on "+pieces[0]+" for "+pieces[0][j]+" against "+charset),legal=!1;break}pieces[0]=pieces[0].replace(pieces[0][j],langreplace[pieces[0][j]])}if(legal){var pat=tool.makeUniquePattern(pieces[0],1),elem=[pieces[0].toUpperCase(),i,pieces[1],""];elem[3]=i<500?0:i<1e3?1:i<2e3?3:i<5e3?4:5,void 0===tool.Frequent[lang][pat]&&(tool.Frequent[lang][pat]=[]),tool.Frequent[lang][pat].push(elem)}}$(".langout").each(function(){$(".langstatus").text("Dumping "+tool.langmap[lang]+"..."),$(this).text(tool.dumpLang(lang))}),$(".langstatus").text(""),tool.updateMatchDropdowns("")});$(".langstatus").text("Loading "+this.langmap[lang]+"...")},genMap:function(){var val=$("input[name=enctype]:checked").val(),keyword=$("#keyword").val(),offset=$("#offset").spinner("value"),keyword2=$("#keyword2").val(),offset2=$("#offset2").spinner("value"),shift=$("#shift").spinner("value");"k1"===val?this.genAlphabetK1(keyword,offset):"k2"===val?this.genAlphabetK2(keyword,offset):"k3"===val?this.genAlphabetK3(keyword,offset,shift):"k4"===val?this.genAlphabetK4(keyword,offset,keyword2,offset2):this.genAlphabetRandom()},setReplacement:function(cset,repl){var i,len,errors;errors="";var charset=this.getCharset();for(i=0,len=repl.length;i<len;i++){var repc=repl.substr(i,1),orig=cset.substr(i,1);this.setChar(orig,repc),repc===orig&&(errors+=repc)}""!==errors&&(console.log(errors),$(".err").text("Bad keyword/offset combo for letters: "+errors))},genAlphabetK1:function(keyword,offset){var repl=this.genKstring(keyword,offset);this.setReplacement(this.getCharset(),repl)},genAlphabetK2:function(keyword,offset){var repl=this.genKstring(keyword,offset);this.setReplacement(repl,this.getCharset())},genAlphabetK3:function(keyword,offset,shift){var repl=this.genKstring(keyword,offset),cset=repl.substr(shift)+repl.substr(0,shift);this.setReplacement(cset,repl)},genAlphabetK4:function(keyword,offset,keyword2,offset2){var cset=this.genKstring(keyword,offset),repl=this.genKstring(keyword2,offset2);this.setReplacement(cset,repl)},genKstring:function(keyword,offset){var unasigned=this.getCharset(),repl="",i,len;for(i=0,len=keyword.length;i<len;i++){var c=keyword.substr(i,1).toUpperCase(),pos=unasigned.indexOf(c);pos>=0&&(repl+=c,unasigned=unasigned.substr(0,pos)+unasigned.substr(pos+1))}return repl=unasigned.substr(unasigned.length-offset)+repl+unasigned.substr(0,unasigned.length-offset)},getRepl:function(){var sel=Math.floor(Math.random()*this.unasigned.length),res=this.unasigned.substr(sel,1);return this.unasigned=this.unasigned.substr(0,sel)+this.unasigned.substr(sel+1),res},genAlphabetRandom:function(){var charset=this.getCharset();this.unasigned=charset;for(var replacement="",pos=0;this.unasigned.length>1;){var orig=charset.substr(pos,1),repl=this.getRepl();if(orig==repl){var newrepl=this.getRepl();this.unasigned+=repl,repl=newrepl}replacement+=repl,pos++}if(charset.substr(pos,1)==this.unasigned){var sel=Math.floor(Math.random()*replacement.length);replacement=replacement.substr(0,sel)+this.unasigned+replacement.substr(sel+1)+replacement.substr(sel,1)}else replacement+=this.unasigned;this.setReplacement(this.getCharset(),replacement)},buildEncoder:function(str){var res=$("<div>"),charset=this.getCharset(),i,len,revRepl=[],encodeline="",decodeline="",lastsplit=-1,splitc="";for(var repc in this.replacement)this.replacement.hasOwnProperty(repc)&&(revRepl[this.replacement[repc]]=repc);for(this.freq=[],i=0,len=charset.length;i<len;i++)this.freq[charset.substr(i,1).toUpperCase()]=0;for(i=0,len=str.length;i<len;i++){var t=str.substr(i,1).toUpperCase(),pos;if(decodeline+=t,charset.indexOf(t)>=0?(t=revRepl[t],isNaN(this.freq[t])&&(this.freq[t]=0),this.freq[t]++):lastsplit=decodeline.length,(encodeline+=t).length>=this.maxEncodeWidth)if(-1===lastsplit)res.append($("<div>",{class:"TOSOLVE"}).text(encodeline)),res.append($("<div>",{class:"TOANSWER"}).text(decodeline)),encodeline="",decodeline="",lastsplit=-1;else{var encodepart=encodeline.substr(0,lastsplit),decodepart=decodeline.substr(0,lastsplit);encodeline=encodeline.substr(lastsplit),decodeline=decodeline.substr(lastsplit),res.append($("<div>",{class:"TOSOLVE"}).text(encodepart)),res.append($("<div>",{class:"TOANSWER"}).text(decodepart))}}return encodeline.length>0&&(res.append($("<div>",{class:"TOSOLVE"}).text(encodeline)),res.append($("<div>",{class:"TOANSWER"}).text(decodeline))),res.html()},initEncoder:function(lang){this.ShowRevReplace=!1,this.curlang=lang,this.setCharset(this.langcharset[lang])},chunk:function(inputString,chunkSize){for(var chunkIndex=1,charset=this.getCharset(),chunkedString="",inputStringLen=inputString.length,i=0;i<inputStringLen;i++)charset.indexOf(inputString.charAt(i).toUpperCase())<0||(chunkIndex%(chunkSize+1)==0&&(chunkedString+=" ",chunkIndex=1),chunkedString+=inputString.charAt(i),chunkIndex++);return chunkedString},loadEncoder:function(){this.hideRevReplace=!0;var encoded=this.cleanString($("#toencode").val());this.chunkIt&&(encoded=this.chunk(encoded,5)),$(".err").text(""),this.genMap();var res=this.build(encoded),tool=this;$("#answer").html(res);for(var i=0;i<this.testStrings.length;i++){var chi=this.CalculateChiSquare(this.testStrings[i]),teststr=this.cleanString(this.testStrings[i]),l=teststr.length;console.log(l+"`"+chi+"`"+teststr)}var chi=this.CalculateChiSquare(encoded),chitext="";isNaN(chi)||(chitext="Chi-Square Value="+chi.toFixed(),chitext+=chi<20?" [Easy]":chi<30?" [Medium]":chi<40?" [Medium Hard]":chi<50?" [Difficult]":" [Extremely Difficult]",chitext+=" Length="+encoded.length,encoded.length<60?chitext+=" [Too Short]":encoded.length<80?chitext+=" [Short]":encoded.length>120?chitext+=" [Too Long]":encoded.length>100&&(chitext+=" [Long]")),$("#chi").text(chitext),this.displayFreq(),this.attachHandlers()},layoutVigenere:function(){var operationChoice=$("<div>"),label=$("<label>",{for:"ops"}).text("Operation");operationChoice.append(label);var radioBox=$("<div>",{id:"ops",class:"ibox"});return radioBox.append($("<input>",{id:"encode",type:"radio",name:"operation",value:"encode",checked:"checked"})),radioBox.append($("<label>",{for:"encode",class:"rlab"}).text("Encode")),radioBox.append($("<input>",{id:"decode",type:"radio",name:"operation",value:"decode"})),radioBox.append($("<label>",{for:"decode",class:"rlab"}).text("Decode")),operationChoice.append(radioBox),operationChoice.html()},setVigenereInputs:function(){var operation;"encode"===$("input[name=operation]:checked").val()?($(":input[id=blocksize]").spinner("value",0),$("div[id=blocksize]").val(""),$("div[id=blocksize]").show(),$(":button").button("option","label","Encode"),this.doEncoding=!0):($("div[id=blocksize]").hide(),$(":button").button("option","label","Decode"),this.doEncoding=!1),$("textarea[id=inputdata]").val(""),$(".ans").text("")},buildVigenere:function(msg,key){var i,charset=this.getCharset(),message="",keyIndex=0,keyString="",cipher="",result=$("<div>"),msgLength=msg.length,keyLength=key.length,lastSplit=-1,c=0,factor=(msgLength/keyLength).toFixed(0);for(i=0;i<factor;i++)keyString=keyString.concat(key);for(keyString+=key.substr(0,msgLength%keyLength),i=0;i<msgLength;i++){var messageChar=msg.substr(i,1).toUpperCase(),m=charset.indexOf(messageChar);if(m>=0){for(var keyChar=keyString.substr(keyIndex,1).toUpperCase(),k=charset.indexOf(keyChar);k<0;)keyIndex++,keyChar=keyString.substr(keyIndex,1).toUpperCase(),k=charset.indexOf(keyChar);if(message+=messageChar,c=this.doEncoding?(m+k)%26:m-k,cipher+=charset.substr(c,1),keyIndex++,message.length>=this.maxEncodeWidth)if(-1===lastSplit)result.append($("<div>",{class:"TOSOLVE"}).text(message)),result.append($("<div>",{class:"TOANSWER"}).text(cipher)),message="",cipher="",lastSplit=-1;else{var messagePart=message.substr(0,lastSplit),cipherPart=cipher.substr(0,lastSplit);message=message.substr(lastSplit),cipher=cipher.substr(lastSplit),result.append($("<div>",{class:"TOSOLVE"}).text(messagePart)),result.append($("<div>",{class:"TOANSWER"}).text(cipherPart))}}else message+=messageChar,lastSplit=(cipher+=messageChar).length}return message.length>0&&(result.append($("<div>",{class:"TOSOLVE"}).text(message)),result.append($("<div>",{class:"TOANSWER"}).text(cipher))),result.html()},loadVigenere:function(){var encoded=this.cleanString($("#inputdata").val()),blockSize=parseInt($("input[id=blocksize").val());blockSize>0&&blockSize<this.maxEncodeWidth&&(encoded=this.chunk(encoded,blockSize));var key=this.cleanString($("#keystring").val());$("#err").text("");var res=this.build(encoded,key);$("#answer").html(res),this.attachHandlers()},initAffine:function(){this.ShowRevReplace=!1,this.affineCheck.p=-1,this.affineCheck.q=-1,this.affineCheck.r=-1,this.affineCheck.s=-1,$("[id='solve']").prop("disabled",!0),$("[id='solve']").prop("value","Select 2 hint letters"),console.log("Init..."+this.affineCheck.p)},buildAffine:function(msg,a,b){var i,charset=this.getCharset(),message="",cipher="",result=$("<div>"),msgLength=msg.length,lastSplit=-1,c="",table=$("<table/>").addClass("tfreq"),tableBody=$("<tbody/>"),messageRow=$("<tr/>"),cipherRow=$("<tr/>");for(i=0;i<msgLength;i++){var messageChar=msg.substr(i,1).toUpperCase(),cipherChar="",m;charset.indexOf(messageChar)>=0?(message+=messageChar,cipher+=cipherChar=this.affinechar(a,b,messageChar),messageRow.append($('<td id="m'+i+'"/>').addClass("TOANSWER").text(messageChar)),cipherRow.append($('<td id="'+i+'"/>').addClass("TOSOLVE").text(cipherChar))):(message+=messageChar,lastSplit=(cipher+=messageChar).length)}return message.length>0&&(tableBody.append(cipherRow),tableBody.append(messageRow)),table.append(tableBody),table},solveIt:function(m1,c1,m2,c2){for(var answer="Can't solve.",c=c1-c2,m=m1-m2;m<0;)m+=26;for(;(c<0||c%m!=0)&&c<626;)c+=26;var A=c/m;if(console.log("A="+A),A%2!=1||A<1||A>25)return answer;for(var B=(c1-A*m1)%26;B<0;)B+=26;return"A = "+A+"; B = "+B},loadAffine:function(){var charset=this.getCharset(),a=$("#a").spinner("value"),b=$("#b").spinner("value");if(!this.iscoprime(a))return console.log("not coprime"),$("#err").text("A value of "+a+" is not coprime with "+charset.length),"";var toencode=this.cleanString($("#toencode").val());console.log("a="+a+" b="+b+" encode="+toencode);var res=this.build(toencode,a,b);$("#answer").html(res),$("td").click(function(){console.log("clicked "+$(this).get);var id=$(this).attr("id");console.log("id = "+id),console.log("other = "+$("td#"+id+".TOSOLVE").text()+" nother = "+$("td#"+id+".TOANSWER").text());var clickedId=CipherTool.affineCheck.olderId,sol,expected;(-1!==clickedId&&$("td#"+clickedId+".TOSOLVECLICK").removeClass("TOSOLVECLICK").addClass("TOSOLVE"),$("td#"+id+".TOSOLVE").removeClass("TOSOLVE").addClass("TOSOLVECLICK"),CipherTool.affineCheck.q=CipherTool.affineCheck.p,CipherTool.affineCheck.s=CipherTool.affineCheck.r,CipherTool.affineCheck.p=charset.indexOf($("td#m"+id+".TOANSWER").text()),CipherTool.affineCheck.r=charset.indexOf($("td#"+id+".TOSOLVECLICK").text()),CipherTool.affineCheck.olderId=CipherTool.affineCheck.oldId,CipherTool.affineCheck.oldId=parseInt(id),-1!==CipherTool.affineCheck.p&&-1!==CipherTool.affineCheck.q)&&(console.log("solve: "),CipherTool.solveIt(CipherTool.affineCheck.p,CipherTool.affineCheck.r,CipherTool.affineCheck.q,CipherTool.affineCheck.s)==="A = "+$("#a").val()+"; B = "+$("#b").val()?(console.log("showing button"),$("[id='solve']").prop("disabled",!1),$("[id='solve']").prop("value","Display Solution")):(console.log("hiding button"),$("[id='solve']").prop("disabled",!0),$("[id='solve']").prop("value","Indeterminate Solution")))})},CipherMappings:{Morbit:{init:"initMorbitSolver",normalizeHTML:"normalizeMorseHTML",createFreqEditTable:"createMorseFreqEditTable",load:"loadMorseSolver",reset:"resetSolver",build:"buildMorseSolver",makeFreqEditField:"makeMorbitEditField",updateSel:"updateMorbitSel",getMorseMap:"getMorbitMorseMap",setMorseMapEntry:"setMorbitMorseMapEntry",setChar:"setStandardChar",setMultiChars:"setMorseMultiChars",updateMatchDropdowns:"updateStandardMatchDropdowns",findPossible:"findMorse"},FractionatedMorse:{init:"initFractionatedMorseSolver",normalizeHTML:"normalizeMorseHTML",createFreqEditTable:"createMorseFreqEditTable",load:"loadMorseSolver",reset:"resetSolver",build:"buildMorseSolver",makeFreqEditField:"makeFractionatedMorseEditField",updateSel:"updateFractionatedMorseSel",getMorseMap:"getFractionatedMorseMap",setMorseMapEntry:"setFractionatedMorseMapEntry",setChar:"setStandardChar",setMultiChars:"setMorseMultiChars",updateMatchDropdowns:"updateStandardMatchDropdowns",findPossible:"findMorse"},Checkerboard:{init:"initCheckerboardSolver",normalizeHTML:"normalizeHTML",createFreqEditTable:"createCheckerboardFreqEditTable",load:"loadCheckerboardSolver",reset:"resetSolver",build:"buildCheckerboardSolver",makeFreqEditField:"makeEditField",updateSel:"updateCheckerboardSel",setChar:"setStandardChar",setMultiChars:"setStandardMultiChars",updateMatchDropdowns:"updateStandardMatchDropdowns",findPossible:"findCheckerboard"},Gromark:{init:"initGromarkSolver",normalizeHTML:"normalizeHTML",createFreqEditTable:"createGromarkFreqEditTable",load:"loadSolver",reset:"resetSolver",build:"buildGromarkSolver",makeFreqEditField:"makeEditField",updateSel:"updateCheckerboardSel",setChar:"setGromarkChar",setMultiChars:"setGromarkMultiChars",updateMatchDropdowns:"updateGromarkMatchDropdowns",findPossible:"findGromark"},Xenocrypt:{init:"init",normalizeHTML:"normalizeHTML",createFreqEditTable:"createNormalFreqEditTable",load:"loadSolver",reset:"resetSolver",build:"buildSolver",makeFreqEditField:"makeEditField",updateSel:"updateStandardSel",setChar:"setStandardChar",setMultiChars:"setStandardMultiChars",updateMatchDropdowns:"updateStandardMatchDropdowns",findPossible:"findStandard"},Standard:{init:"init",normalizeHTML:"normalizeHTML",createFreqEditTable:"createNormalFreqEditTable",load:"loadSolver",reset:"resetSolver",build:"buildSolver",makeFreqEditField:"makeEditField",updateSel:"updateStandardSel",setChar:"setStandardChar",setMultiChars:"setStandardMultiChars",updateMatchDropdowns:"updateStandardMatchDropdowns",findPossible:"findStandard"},Encoder:{init:"initEncoder",normalizeHTML:"normalizeHTML",createFreqEditTable:"createNormalFreqEditTable",load:"loadEncoder",reset:"resetSolver",build:"buildEncoder",makeFreqEditField:"makeViewField",updateSel:"updateStandardSel",setChar:"setStandardChar",setMultiChars:"setStandardMultiChars",updateMatchDropdowns:"updateStandardMatchDropdowns",findPossible:"findStandard"},Vigenere:{init:"initEncoder",normalizeHTML:"normalizeHTML",createFreqEditTable:"createNormalFreqEditTable",load:"loadVigenere",reset:"resetSolver",build:"buildVigenere",makeFreqEditField:"makeViewField",updateSel:"updateStandardSel",setChar:"setStandardChar",setMultiChars:"setStandardMultiChars",updateMatchDropdowns:"updateStandardMatchDropdowns",findPossible:"findStandard"},Affine:{init:"initAffine",normalizeHTML:"normalizeHTML",createFreqEditTable:"createNormalFreqEditTable",load:"loadAffine",reset:"resetSolver",build:"buildAffine",makeFreqEditField:"makeViewField",updateSel:"updateStandardSel",setChar:"setStandardChar",setMultiChars:"setStandardMultiChars",updateMatchDropdowns:"updateStandardMatchDropdowns",findPossible:"findStandard"}},select:function(ciphertype,lang){for(var target in console.log("Selecting:"+ciphertype+" lang="+lang),void 0===this.CipherMappings[ciphertype]&&(ciphertype="Standard"),void 0===lang&&(lang="en"),lang=lang.toLowerCase(),this.CipherMappings[ciphertype])this.CipherMappings[ciphertype].hasOwnProperty(target)&&(this[target]=this[this.CipherMappings[ciphertype][target]]);this.lang=lang,this.init(lang)}};$(function(){CipherTool.select(void 0,void 0),$("[data-cipher]").each(function(){CipherTool.select($(this).attr("data-cipher"),$(this).attr("data-lang"))}),$(".cipher-type").each(function(){CipherTool.setCipherType($(this).attr("id"))}),$("#load").button().click(function(){CipherTool.load()}),$("#reset").button().click(function(){CipherTool.reset()}),$(".sfind").change(function(){CipherTool.findPossible($(this).val())}).blur(function(){CipherTool.findPossible($(this).val())}),$(".lang").each(function(){CipherTool.setLangDropdown($(this))}),CipherTool.UpdateFreqEditTable(),CipherTool.attachHandlers()});