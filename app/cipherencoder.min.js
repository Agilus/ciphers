var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])};return function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}}(),CipherEncoder=function(_super){function CipherEncoder(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(CipherEncoder,_super),CipherEncoder.prototype.init=function(lang){this.ShowRevReplace=!1,this.curlang=lang,this.setCharset(this.langcharset[lang])},CipherEncoder.prototype.setkvalinputs=function(){var val=$("input[name=enctype]:checked").val();"random"===val?$(".kval").hide():$(".kval").show(),"k3"===val?$(".k3val").show():$(".k3val").hide(),"k4"===val?$(".k4val").show():$(".k4val").hide()},CipherEncoder.prototype.attachHandlers=function(){var tool=this;$("input[type=radio][name=enctype]").change(function(){tool.setkvalinputs()}),tool.setkvalinputs(),_super.prototype.attachHandlers.call(this)},CipherEncoder.prototype.setCipherType=function(cipherType){"patristocrat"==cipherType&&(console.log(cipherType+" -- set chunking."),this.chunkIt=!0),this.attachHandlers()},CipherEncoder.prototype.genMap=function(){var val=$("input[name=enctype]:checked").val(),keyword=$("#keyword").val(),offset=$("#offset").spinner("value"),keyword2=$("#keyword2").val(),offset2=$("#offset2").spinner("value"),shift=$("#shift").spinner("value");"k1"===val?this.genAlphabetK1(keyword,offset):"k2"===val?this.genAlphabetK2(keyword,offset):"k3"===val?this.genAlphabetK3(keyword,offset,shift):"k4"===val?this.genAlphabetK4(keyword,offset,keyword2,offset2):this.genAlphabetRandom()},CipherEncoder.prototype.setReplacement=function(cset,repl){var i,len,errors;errors="";var charset=this.getCharset();for(i=0,len=repl.length;i<len;i++){var repc=repl.substr(i,1),orig=cset.substr(i,1);this.setChar(orig,repc),repc===orig&&(errors+=repc)}""!==errors&&(console.log(errors),$(".err").text("Bad keyword/offset combo for letters: "+errors))},CipherEncoder.prototype.genAlphabetK1=function(keyword,offset){var repl=this.genKstring(keyword,offset);this.setReplacement(this.getCharset(),repl)},CipherEncoder.prototype.genAlphabetK2=function(keyword,offset){var repl=this.genKstring(keyword,offset);this.setReplacement(repl,this.getCharset())},CipherEncoder.prototype.genAlphabetK3=function(keyword,offset,shift){var repl=this.genKstring(keyword,offset),cset=repl.substr(shift)+repl.substr(0,shift);this.setReplacement(cset,repl)},CipherEncoder.prototype.genAlphabetK4=function(keyword,offset,keyword2,offset2){var cset=this.genKstring(keyword,offset),repl=this.genKstring(keyword2,offset2);this.setReplacement(cset,repl)},CipherEncoder.prototype.genKstring=function(keyword,offset){var unasigned=this.getCharset(),repl="",i,len;for(i=0,len=keyword.length;i<len;i++){var c=keyword.substr(i,1).toUpperCase(),pos=unasigned.indexOf(c);pos>=0&&(repl+=c,unasigned=unasigned.substr(0,pos)+unasigned.substr(pos+1))}return repl=unasigned.substr(unasigned.length-offset)+repl+unasigned.substr(0,unasigned.length-offset)},CipherEncoder.prototype.getRepl=function(){var sel=Math.floor(Math.random()*this.unasigned.length),res=this.unasigned.substr(sel,1);return this.unasigned=this.unasigned.substr(0,sel)+this.unasigned.substr(sel+1),res},CipherEncoder.prototype.genAlphabetRandom=function(){var charset=this.getCharset();this.unasigned=charset;for(var replacement="",pos=0;this.unasigned.length>1;){var orig=charset.substr(pos,1),repl=this.getRepl();if(orig==repl){var newrepl=this.getRepl();this.unasigned+=repl,repl=newrepl}replacement+=repl,pos++}if(charset.substr(pos,1)==this.unasigned){var sel=Math.floor(Math.random()*replacement.length);replacement=replacement.substr(0,sel)+this.unasigned+replacement.substr(sel+1)+replacement.substr(sel,1)}else replacement+=this.unasigned;this.setReplacement(this.getCharset(),replacement)},CipherEncoder.prototype.build=function(str){var res=$("<div>"),charset=this.getCharset(),i,len,revRepl=[],encodeline="",decodeline="",lastsplit=-1,splitc="";for(var repc in this.replacement)this.replacement.hasOwnProperty(repc)&&(revRepl[this.replacement[repc]]=repc);for(this.freq=[],i=0,len=charset.length;i<len;i++)this.freq[charset.substr(i,1).toUpperCase()]=0;for(i=0,len=str.length;i<len;i++){var t=str.substr(i,1).toUpperCase(),pos;if(decodeline+=t,charset.indexOf(t)>=0?(t=revRepl[t],isNaN(this.freq[t])&&(this.freq[t]=0),this.freq[t]++):lastsplit=decodeline.length,(encodeline+=t).length>=this.maxEncodeWidth)if(-1===lastsplit)res.append($("<div>",{class:"TOSOLVE"}).text(encodeline)),res.append($("<div>",{class:"TOANSWER"}).text(decodeline)),encodeline="",decodeline="",lastsplit=-1;else{var encodepart=encodeline.substr(0,lastsplit),decodepart=decodeline.substr(0,lastsplit);encodeline=encodeline.substr(lastsplit),decodeline=decodeline.substr(lastsplit),res.append($("<div>",{class:"TOSOLVE"}).text(encodepart)),res.append($("<div>",{class:"TOANSWER"}).text(decodepart))}}return encodeline.length>0&&(res.append($("<div>",{class:"TOSOLVE"}).text(encodeline)),res.append($("<div>",{class:"TOANSWER"}).text(decodeline))),res},CipherEncoder.prototype.load=function(){var encoded=this.cleanString($("#toencode").val());this.chunkIt&&(encoded=this.chunk(encoded,5)),$(".err").text(""),this.genMap();var res=this.build(encoded),tool=this;$("#answer").replaceWith(res);for(var i=0;i<this.testStrings.length;i++){var chi=this.CalculateChiSquare(this.testStrings[i]),teststr=this.cleanString(this.testStrings[i]),l=teststr.length;console.log(l+"`"+chi+"`"+teststr)}var chi=this.CalculateChiSquare(encoded),chitext="";isNaN(chi)||(chitext="Chi-Square Value="+chi.toFixed(),chitext+=chi<20?" [Easy]":chi<30?" [Medium]":chi<40?" [Medium Hard]":chi<50?" [Difficult]":" [Extremely Difficult]",chitext+=" Length="+encoded.length,encoded.length<60?chitext+=" [Too Short]":encoded.length<80?chitext+=" [Short]":encoded.length>120?chitext+=" [Too Long]":encoded.length>100&&(chitext+=" [Lnpm innpm